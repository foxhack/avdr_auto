*** Settings ***
Resource          kw_utils.robot

*** Variables ***
${vulnerability_file}    testdata/asset/data.json

*** Keywords ***
Import Vulnerability Info
    [Arguments]    ${ip}
    ${sql}=    Set Variable    select config from system_config where type = 'API_KEY'
    ${api_key}    Execute Mysql Cmd    ${sql}
    Module Exec    Vulnerability    import_vul    local_file=${vulnerability_file}    ip=${ip}    api_key=${api_key}

Get Vul Detail
    [Arguments]    ${ip}    ${name}    ${type}
    ${filter}    Create Dictionary    ip=${ip}    name=${name}    type=${type}
    ${vul_detail}    Module Exec    Vulnerability    vul_detail    filter=${filter}
    [Return]    ${vul_detail}

Get Vul
    [Arguments]    ${start_time}=${EMPTY}    ${end_time}=${EMPTY}    ${filter_expression}=${EMPTY}
    ${vul_data}    Module Exec    Vulnerability    vul_list
    [Return]    ${vul_data}

Vul Status
    [Arguments]    ${_id}    ${confirm_status}    ${reason}
    ${status_list}    Module Exec    Vulnerability    vul_status    _id=${_id}    confirm_status=${confirm_status}    reason=${reason}
    [Return]    ${status_list}

Vul Knowledge
    [Arguments]    ${id}
    ${vul_know}    Module Exec    Vulnerability    get_knowledge    id=${id}
    [Return]    ${vul_know}
