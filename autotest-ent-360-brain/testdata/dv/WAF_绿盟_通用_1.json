{
  "name": "WAF_绿盟_通用_1",
  "createtime": 1505699772548,
  "assetType": {
    "name": "Linux",
    "createtime": 1505699808371,
    "lasttime": 1505699808371,
    "id": "B0IB65OD000a",
    "parentId": "6JAMVDVH0008"
  },
  "description": "websec日志解析规则",
  "normalize": [{
    "mappings": [{
      "mappingType": "EQUAL",
      "orgValue": "No",
      "mappingValue": "/fail"
    }, {
      "mappingType": "EQUAL",
      "orgValue": "Yes",
      "mappingValue": "/success"
    }],
    "field": "result",
    "result": "No",
    "value": "",
    "index": "12"
  }, {
    "mappings": [],
    "field": "operation",
    "result": "Block",
    "value": "",
    "index": "11"
  }, {
    "mappings": [{
      "mappingType": "EQUAL",
      "orgValue": "OS_CMD_Injection",
      "mappingValue": "web攻击其他注入"
    }, {
      "mappingType": "EQUAL",
      "orgValue": "SQL_Injection",
      "mappingValue": "web攻击sql注入"
    }, {
      "mappingType": "EQUAL",
      "orgValue": "Cross_Site_Scripting",
      "mappingValue": "web攻击跨站脚本"
    }, {
      "mappingType": "EQUAL",
      "orgValue": "Scan_Anti",
      "mappingValue": "web扫描"
    }, {
      "mappingType": "EQUAL",
      "orgValue": "Web_Server_Bug",
      "mappingValue": "服务器漏洞web攻击"
    }, {
      "mappingType": "EQUAL",
      "orgValue": "Path_Traversal",
      "mappingValue": "web攻击路径遍历"
    }, {
      "mappingType": "EQUAL",
      "orgValue": "Download_limit",
      "mappingValue": "web攻击上传下载"
    }, {
      "mappingType": "EQUAL",
      "orgValue": "Down_load_limit",
      "mappingValue": "web攻击上传下载"
    }, {
      "mappingType": "EQUAL",
      "orgValue": "HTTP_Protocol_Validation",
      "mappingValue": "web攻击报文头异常"
    }, {
      "mappingType": "EQUAL",
      "orgValue": "Web_Plugin_Bug",
      "mappingValue": "组件漏洞web攻击"
    }, {
      "mappingType": "EQUAL",
      "orgValue": "XPATH",
      "mappingValue": "web攻击其他注入"
    }, {
      "mappingType": "EQUAL",
      "orgValue": "Anti_leech",
      "mappingValue": "反盗链防护"
    }, {
      "mappingType": "EQUAL",
      "orgValue": "RFI",
      "mappingValue": "web攻击文件包含"
    }, {
      "mappingType": "EQUAL",
      "orgValue": "File_Upload_Limit",
      "mappingValue": "web攻击上传下载"
    }],
    "field": "event_name",
    "result": "HTTP_Protocol_Validation ",
    "value": "",
    "index": "9"
  }, {
    "mappings": [],
    "field": "merge_count",
    "result": "1",
    "value": "",
    "index": "15"
  }, {
    "mappings": [],
    "field": "product",
    "result": "WAF",
    "value": "",
    "index": "product"
  }, {
    "mappings": [],
    "field": "vendor",
    "result": "绿盟",
    "value": "",
    "index": "vendor"
  }, {
    "mappings": [],
    "field": "dst_port",
    "result": "80",
    "value": "",
    "index": "2"
  }, {
    "mappings": [],
    "field": "src_port",
    "result": "28684",
    "value": "",
    "index": "4"
  }, {
    "mappings": [{
      "mappingType": "TIME",
      "orgValue": "",
      "mappingValue": "yyyy-MM-dd HH:mm:ss"
    }],
    "field": "occur_time",
    "result": "2017-02-18 11:12:19",
    "value": "",
    "index": "10"
  }, {
    "mappings": [],
    "field": "dst_address",
    "result": "172.17.100.105",
    "value": "",
    "index": "1"
  }, {
    "mappings": [],
    "field": "src_address",
    "result": "211.22.90.249",
    "value": "",
    "index": "3"
  }, {
    "mappings": [{
      "mappingType": "REGULAR",
      "orgValue": "^((?!LOW).)*$",
      "mappingValue": "1"
    }, {
      "mappingType": "EQUAL",
      "orgValue": "LOW",
      "mappingValue": "0"
    }],
    "field": "event_level",
    "result": "MEDIUM",
    "value": "",
    "index": "8"
  }, {
    "mappings": [],
    "field": "event_digest",
    "result": "request method begin with non-capital letters or over load content-lenth ",
    "value": "",
    "index": "14"
  }, {
    "mappings": [],
    "field": "url",
    "result": "None",
    "value": "",
    "index": "7"
  }, {
    "mappings": [],
    "field": "host_name",
    "result": "None",
    "value": "",
    "index": "6"
  }, {
    "mappings": [],
    "field": "request_Method",
    "result": "UNKNOWN",
    "value": "",
    "index": "5"
  }, {
    "mappings": [],
    "field": "reason",
    "result": "None ",
    "value": "",
    "index": "13"
  }, {
    "mappings": [],
    "field": "original_log",
    "result": "<11>Feb 18 11:12:23 localhost waf: tag:waf_log_websec site_id:1428395845  protect_id:2442566278  dst_ip:172.17.100.105  dst_port:80  src_ip:211.22.90.249  src_port:28684  method:UNKNOWN  domain:None  uri:None  alertlevel:MEDIUM  event_type:HTTP_Protocol_Validation  stat_time:2017-02-18 11:12:19  policy_id:1  rule_id:0  action:Block  block:No  block_info:None  http:\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001  alertinfo:request method begin with non-capital letters or over load content-lenth  proxy_info:None  characters:None  count_num:1  protocol_type:HTTP  wci:None  wsi:None",
    "value": "",
    "index": "original_log"
  }],
  "lasttime": 1505699772548,
  "parser": {
    "value": "(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\\s+\\d{1,2}\\s+\\d{2}:\\d{2}:\\d{2}\\s+\\S+\\s+\\S+:\\s+tag:\\S+\\s+site_id:\\d+\\s+protect_id:\\d+\\s+dst_ip:((?:\\d{1,3}\\.){3}\\d{1,3})\\s+dst_port:(\\d+)\\s+src_ip+:((?:\\d{1,3}\\.){3}\\d{1,3})\\s+src_port:(\\d+)\\s+method:(\\S+)\\s+domain:(.*?)\\s+uri:(.*?)\\s+alertlevel:(\\S+)\\s+event_type:(.*)\\s+stat_time:(\\d{4}-\\d{2}-\\d{2}\\s+\\d{1,2}:\\d{1,2}:\\d{1,2})\\s+policy_id:\\d+\\s+rule_id:\\d+\\s+action:(\\S+)\\s+block:(\\S+)\\s+block_info:(.*)\\s+http:.*?\\s+(?:Host:.*?)?alertinfo:(.*)\\s+proxy_info:.*count_num:(\\d+)\\s+protocol_type:(\\S+).*",
    "filter": [{
      "fields": {
        "product": "WAF"
      },
      "name": "addFields"
    }, {
      "fields": {
        "vendor": "绿盟"
      },
      "name": "addFields"
    }],
    "name": "orgRegex"
  },
  "properties": [{
    "format": null,
    "name": "目的地址",
    "key": "dst_address",
    "id": "c2f0fe17-3b76-4fd7-a89f-98eddf8af450",
    "sample": "172.17.100.105",
    "type": "string"
  }, {
    "format": null,
    "name": "目的端口",
    "key": "dst_port",
    "id": "1749c85c-6075-4108-9a7e-a618429b3e4c",
    "sample": "80",
    "type": "string"
  }, {
    "format": null,
    "name": "事件摘要",
    "key": "event_digest",
    "id": "84a50bb2-0c48-413b-87f8-c47e7d5a01ac",
    "sample": "request method begin with non-capital letters or over load content-lenth",
    "type": "string"
  }, {
    "format": null,
    "name": "事件级别",
    "key": "event_level",
    "id": "37cdd086-43be-471c-bf55-475fe68007cc",
    "sample": "警告",
    "type": "string"
  }, {
    "format": null,
    "name": "事件名称",
    "key": "event_name",
    "id": "8a380a24-c68c-4709-917d-3d627d0ee4ed",
    "sample": "web攻击报文头异常",
    "type": "string"
  }, {
    "format": null,
    "name": "事件分类",
    "key": "event_type",
    "id": "722e1422-9873-4cb7-b6e8-b14d607ca943",
    "sample": "web攻击",
    "type": "string"
  }, {
    "format": null,
    "name": "主机名称",
    "key": "host_name",
    "id": "1990dd1a-96d3-4922-857d-61cb0941f96c",
    "sample": "None",
    "type": "string"
  }, {
    "format": null,
    "name": "合并数量",
    "key": "merge_count",
    "id": "d3dca015-c93f-422a-9019-0419c84c9fcd",
    "sample": "1",
    "type": "string"
  }, {
    "format": null,
    "name": "发生时间",
    "key": "occur_time",
    "id": "4dcf857a-0155-4aad-88ee-0390a55c09bf",
    "sample": "1487387539000",
    "type": "string"
  }, {
    "format": null,
    "name": "操作",
    "key": "operation",
    "id": "6531e395-b6b3-4670-9ea9-439ab86640de",
    "sample": "Block",
    "type": "string"
  }, {
    "format": null,
    "name": "原始日志",
    "key": "original_log",
    "id": "4aebf7d9-2774-4249-93c0-0597981f22d8",
    "sample": "<11>Feb 18 11:12:23 localhost waf: tag:waf_log_websec site_id:1428395845  protect_id:2442566278  dst_ip:172.17.100.105  dst_port:80  src_ip:211.22.90.249  src_port:28684  method:UNKNOWN  domain:None  uri:None  alertlevel:MEDIUM  event_type:HTTP_Protocol_Validation  stat_time:2017-02-18 11:12:19  policy_id:1  rule_id:0  action:Block  block:No  block_info:None  http:\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001  alertinfo:request method begin with non-capital letters or over load content-lenth  proxy_info:None  characters:None  count_num:1  protocol_type:HTTP  wci:None  wsi:None",
    "type": "string"
  }, {
    "format": null,
    "name": "产品",
    "key": "product",
    "id": "e7f83a9e-5f37-406e-983a-c31fa3315813",
    "sample": "WAF",
    "type": "string"
  }, {
    "format": null,
    "name": "原因",
    "key": "reason",
    "id": "8d9b3931-56a4-42b4-9c76-4f2d4fa826d2",
    "sample": "None",
    "type": "string"
  }, {
    "format": null,
    "name": "获取方法",
    "key": "request_Method",
    "id": "6fa6a45e-89e1-4226-b910-8096b6b7e59d",
    "sample": "UNKNOWN",
    "type": "string"
  }, {
    "format": null,
    "name": "结果",
    "key": "result",
    "id": "cbaf3328-e4f3-47ad-b6e7-ca33bbbafda4",
    "sample": "失败",
    "type": "string"
  }, {
    "format": null,
    "name": "源地址",
    "key": "src_address",
    "id": "fdcdbfab-821b-47d9-8d9d-9d3a62494d9d",
    "sample": "211.22.90.249",
    "type": "string"
  }, {
    "format": null,
    "name": "源端口",
    "key": "src_port",
    "id": "9df694d1-8bcd-4720-80a2-fbc2c220ea83",
    "sample": "28684",
    "type": "string"
  }, {
    "format": null,
    "name": "网址",
    "key": "url",
    "id": "9ec26c0b-c3ef-4de1-849f-155548691d22",
    "sample": "None",
    "type": "string"
  }, {
    "format": null,
    "name": "厂商",
    "key": "vendor",
    "id": "1d5f5eb6-47af-4b32-a832-f50bd1a124e6",
    "sample": "绿盟",
    "type": "string"
  }],
  "sample": "<11>Feb 18 11:12:23 localhost waf: tag:waf_log_websec site_id:1428395845  protect_id:2442566278  dst_ip:172.17.100.105  dst_port:80  src_ip:211.22.90.249  src_port:28684  method:UNKNOWN  domain:None  uri:None  alertlevel:MEDIUM  event_type:HTTP_Protocol_Validation  stat_time:2017-02-18 11:12:19  policy_id:1  rule_id:0  action:Block  block:No  block_info:None  http:\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001  alertinfo:request method begin with non-capital letters or over load content-lenth  proxy_info:None  characters:None  count_num:1  protocol_type:HTTP  wci:None  wsi:None"
}